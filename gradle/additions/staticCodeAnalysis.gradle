import java.nio.file.Files

sca.ciEnabled project.hasProperty('ciRun') ? project.findProperty('ciRun').toBoolean() : false

// Use mdm-core to supply all the SCA files
java.nio.file.Path codenarcPath = Files.createTempFile('codenarc', '.groovy')
Files.write(codenarcPath,
            'https://raw.githubusercontent.com/MauroDataMapper/mdm-core/develop/gradle/static_code_analysis/codenarc_rules.groovy'.toURL().readLines())

java.nio.file.Path spotbugsPath = Files.createTempFile('spotbugs', '.xml')
Files.write(spotbugsPath,
            'https://raw.githubusercontent.com/MauroDataMapper/mdm-core/develop/gradle/static_code_analysis/spotbugs_exclude.xml'.toURL().readLines())

java.nio.file.Path checkstylePath = Files.createTempFile('checkstyle', '.xml')
Files.write(checkstylePath,
            'https://raw.githubusercontent.com/MauroDataMapper/mdm-core/develop/gradle/static_code_analysis/checkstyle.xml'.toURL().readLines())

codenarc {
    configFile = file(codenarcPath)
}

spotbugs {
    excludeFilter = file(spotbugsPath)
}

checkstyle {
    configFile = file(checkstylePath)
}

pmd {
    ruleSets = ['category/java/errorprone.xml', 'category/java/bestpractices.xml']
}